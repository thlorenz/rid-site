<!DOCTYPE html>
<html lang="en-US">
<head>
<meta charset="utf-8">
<meta http-equiv="x-ua-compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

  <link rel="preload" as="font" href="https://thlorenz.com/rid-site/fonts/vendor/jost/jost-v4-latin-regular.woff2" type="font/woff2" crossorigin>
  <link rel="preload" as="font" href="https://thlorenz.com/rid-site/fonts/vendor/jost/jost-v4-latin-700.woff2"  type="font/woff2" crossorigin>


<link rel="stylesheet" href="https://thlorenz.com/rid-site/main.css">



  
  
    
  

  
  
    
    
  
  
  
    
  
  
  
  
    
  
  
  


  <meta name="robots" content="index, follow">
  <meta name="googlebot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">
  <meta name="bingbot" content="index, follow, max-snippet:-1, max-image-preview:large, max-video-preview:-1">


	


	

<title>Application Architecture | Rid</title>
<meta name="description" content="Explains the Rid application architecture.">
<link rel="canonical" href="https://thlorenz.com/rid-site/docs/getting-started/architecture/">


  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:image" content="rid-card.png">
  <meta name="twitter:title" content="Application Architecture">
  <meta name="twitter:description" content="Explains the Rid application architecture.">
  <meta name="twitter:site" content="@thlorenz">
  <meta name="twitter:creator" content="@thlorenz">
  
  <meta property="og:title" content="Application Architecture">
  <meta property="og:description" content="Explains the Rid application architecture.">
  <meta property="og:type" content="article">
  <meta property="og:url" content="https://thlorenz.com/rid-site/docs/getting-started/architecture/">

  
    <meta property="og:image" content="rid-card.png">
  

  <meta property="og:updated_time" content="2021-05-13">
  <meta property="og:site_name" content="Application Architecture">

  

  

  
  <meta property="article:author" content="https://www.twitter.com/Thorsten Lorenz">
  <meta property="og:locale" content="en_US">





  





<script type="application/ld+json">
  {
    "@context": "http://schema.org",
    "@type": "BreadcrumbList",
    
      
      
        
        
        
        
        
        
        
        
          {
            "@type": "ListItem",
            "position":  1 ,
            "name": "Home",
            "item": "https://thlorenz.com/rid-site/"
          },
          
          
          {
            "@type": "ListItem",
            "position":  2 ,
            "name": "Docs",
            "item": "https://thlorenz.com/rid-site/docs/"
          },
        
      
        
        
        
        
        
        
        
        
        
        
        
          
          
          {
            "@type": "ListItem",
            "position":  3 ,
            "name": "Getting Started",
            "item": "https://thlorenz.com/rid-site/docs/getting-started/"
          },
        
      
        
        
        
        
        
        
        
        
          
          
          {
            "@type": "ListItem",
            "position":  4 ,
            "name": "Architecture",
            "item": "https://thlorenz.com/rid-site/docs/getting-started/architecture/"
          },
        
      
    
  }
</script>




  <meta name="theme-color" content="#fff">
  <link rel="apple-touch-icon" sizes="180x180" href="https://thlorenz.com/rid-site/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://thlorenz.com/rid-site/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://thlorenz.com/rid-site/favicon-16x16.png">
  


  

</head>

  

<body class="docs single">
  
  
  
  
<div class="header-bar fixed-top"></div>
<header class="navbar fixed-top navbar-expand-md navbar-light">
	<div class="container">
		<input class="menu-btn order-0" type="checkbox" id="menu-btn">
		<label class="menu-icon d-md-none" for="menu-btn"><span class="navicon"></span></label>
		<a class="navbar-brand order-1 order-md-0 me-auto" href="https://thlorenz.com/rid-site">Rid</a>
		<button id="mode" class="btn btn-link order-2 order-md-4" type="button" aria-label="Toggle mode">
			<span class="toggle-dark"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-moon"><path d="M21 12.79A9 9 0 1 1 11.21 3 7 7 0 0 0 21 12.79z"></path></svg></span>
			<span class="toggle-light"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-sun"><circle cx="12" cy="12" r="5"></circle><line x1="12" y1="1" x2="12" y2="3"></line><line x1="12" y1="21" x2="12" y2="23"></line><line x1="4.22" y1="4.22" x2="5.64" y2="5.64"></line><line x1="18.36" y1="18.36" x2="19.78" y2="19.78"></line><line x1="1" y1="12" x2="3" y2="12"></line><line x1="21" y1="12" x2="23" y2="12"></line><line x1="4.22" y1="19.78" x2="5.64" y2="18.36"></line><line x1="18.36" y1="5.64" x2="19.78" y2="4.22"></line></svg></span>
		</button>
		<ul class="navbar-nav fork-me order-3 order-md-5">
			
				
					<li class="nav-item">
						<a class="nav-link" href="https://twitter.com/thlorenz"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-twitter"><path d="M23 3a10.9 10.9 0 0 1-3.14 1.53 4.48 4.48 0 0 0-7.86 3v1A10.66 10.66 0 0 1 3 4s-4 9 5 13a11.64 11.64 0 0 1-7 2c9 5 20 0 20-11.5a4.5 4.5 0 0 0-.08-.83A7.72 7.72 0 0 0 23 3z"></path></svg><span class="ms-2 visually-hidden">Twitter</span></a>
					</li>
				
					<li class="nav-item">
						<a class="nav-link" href="https://github.com/thlorenz/rid-examples"><svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-github"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg><span class="ms-2 visually-hidden">GitHub</span></a>
					</li>
				
			
		</ul>
		<div class="collapse navbar-collapse order-4 order-md-1">
			<ul class="navbar-nav main-nav me-auto order-5 order-md-2">
				
					
						<li class="nav-item docs active">
							<a class="nav-link" href="https://thlorenz.com/rid-site/docs/getting-started/introduction/">Docs</a>
						</li>
					
						<li class="nav-item">
							<a class="nav-link" href="https://thlorenz.com/rid-site/blog/">Blog</a>
						</li>
					
				
        <li class="btn btn-link order-2 order-md-4" aria-label="Sponsor @thlorenz on GitHub">
          <a class="github-button" href="https://github.com/sponsors/thlorenz" data-icon="octicon-heart" aria-label="Sponsor @thlorenz on GitHub">Sponsor</a>
        </li>
			</ul>
			<div class="break order-6 d-md-none"></div>
			
				<form class="navbar-form flex-grow-1 order-7 order-md-3">
					<input id="userinput" class="form-control is-search" type="search" placeholder="Search docs..."
						aria-label="Search docs..." autocomplete="off">
					<div id="suggestions" class="shadow bg-white rounded"></div>
				</form>
			
		</div>
	</div>
</header>



  
<div class="wrap container" role="document">
  <div class="content">
    <div class="row flex-xl-nowrap">
	  
<div class="col-lg-5 col-xl-4 docs-sidebar">
	<nav class="docs-links" aria-label="Main navigation">
			
			
			
			
					
					
					
							<h3>Getting Started</h3>
							<ul class="list-unstyled">
							                           
									<li><a class="docs-link" href="https://thlorenz.com/rid-site/docs/getting-started/introduction/">Introduction</a></li>
							                           
									<li><a class="docs-link active" href="https://thlorenz.com/rid-site/docs/getting-started/architecture/">Application Architecture</a></li>
							
					</ul>
					
					
					
					
							<h3>Rid Attributes</h3>
							<ul class="list-unstyled">
							                           
									<li><a class="docs-link" href="https://thlorenz.com/rid-site/docs/rid-attributes/model/">rid::model</a></li>
							                           
									<li><a class="docs-link" href="https://thlorenz.com/rid-site/docs/rid-attributes/store/">rid::store</a></li>
							                           
									<li><a class="docs-link" href="https://thlorenz.com/rid-site/docs/rid-attributes/message-reply/">rid::message and rid::reply</a></li>
							                           
									<li><a class="docs-link" href="https://thlorenz.com/rid-site/docs/rid-attributes/debug/">rid::debug</a></li>
							                           
									<li><a class="docs-link" href="https://thlorenz.com/rid-site/docs/rid-attributes/structs-enums/">rid::structs and rid::enums</a></li>
							
					</ul>
					
					
					
					
							<h3>Examples</h3>
							<ul class="list-unstyled">
							                           
									<li><a class="docs-link" href="https://thlorenz.com/rid-site/docs/examples/flutter-todo-app/">Multithreaded Todo App</a></li>
							                           
									<li><a class="docs-link" href="https://thlorenz.com/rid-site/docs/examples/dart-todo-app/">Dart only Todo App</a></li>
							
					</ul>
					
					
					
					
							<h3>Contributing</h3>
							<ul class="list-unstyled">
							                           
									<li><a class="docs-link" href="https://thlorenz.com/rid-site/docs/contributing/status-and-roadmap/">Status and Roadmap</a></li>
							                           
									<li><a class="docs-link" href="https://thlorenz.com/rid-site/docs/contributing/how-to-contribute/">How to Contribute</a></li>
							                           
									<li><a class="docs-link" href="https://thlorenz.com/rid-site/docs/contributing/sponsor/">Sponsor</a></li>
							                           
									<li><a class="docs-link" href="https://thlorenz.com/rid-site/docs/contributing/code-of-conduct/">Code of Conduct</a></li>
							
					</ul>
					
					
			
	</nav>
</div>

	  
  
  <nav class="docs-toc d-none d-xl-block col-xl-3" aria-label="Secondary navigation">
  	<div class="page-links">
  			<h3>On this page</h3>
  			<nav id="TableOfContents">
  					<ul>
  							
  							<li><a href="https://thlorenz.com/rid-site/docs/getting-started/architecture/#ui-separated-from-app-logic">UI separated from App Logic</a></li>
  							
  							
  							<li><a href="https://thlorenz.com/rid-site/docs/getting-started/architecture/#rust-state-and-logic-implementation">Rust State and Logic Implementation</a></li>
  							
  									<ul>
  											
  											<li><a href="https://thlorenz.com/rid-site/docs/getting-started/architecture/#store-message-and-reply">Store, Message and Reply</a></li>
  											
  									</ul>
  							
  							
  							<li><a href="https://thlorenz.com/rid-site/docs/getting-started/architecture/#accessing-state-and-sending-messages">Accessing State and Sending Messages</a></li>
  							
  							
  							<li><a href="https://thlorenz.com/rid-site/docs/getting-started/architecture/#rid-s-raw-api">Rid&#x27;s Raw Api</a></li>
  							
  									<ul>
  											
  											<li><a href="https://thlorenz.com/rid-site/docs/getting-started/architecture/#how-data-is-passed">How Data is Passed</a></li>
  											
  											<li><a href="https://thlorenz.com/rid-site/docs/getting-started/architecture/#accessing-and-iterating-collections">Accessing and Iterating Collections</a></li>
  											
  									</ul>
  							
  							
  					</ul>
  			</nav>
  	</div>
  </nav>
  

      <main class="docs-content col-lg-11 col-xl-9">
        <h1>Application Architecture</h1>
        <p class="lead">Explains the Rid application architecture.</p>
        <h2 id="ui-separated-from-app-logic">UI separated from App Logic</h2>
<p>Each application created with Rid is divided into two major parts. </p>
<p>The UI implemented in Flutter/Dart concerns itself only with rendering <em>Widgets</em> and user
interaction. It delegates to Rust for all application logic.</p>
<p>All application state is held by Rust. Application logic mutating that state is implemented in
Rust.</p>
<h2 id="rust-state-and-logic-implementation">Rust State and Logic Implementation</h2>
<p>A <em>rid</em> application has one main model, the <em>Store</em>, which holds the application state. This
state is not modified from the UI. Instead the UI sends messages to Rust in order to relay user
interaction. Rust then modifies the state of the application and responds with a <em>Reply</em> in
order to communicate that the message has been handled. At that point the UI can query the
state of the <em>Store</em> and update itself.</p>
<p>All logic needed to derive the new state from the previous one as a result of a user
interaction is implemented in Rust. Flutter only consumes this state and when needed
transforms it slightly and only locally in order to make it presentable via a <em>Widget</em>.</p>
<p>Flutter should never modify the global application state directly.</p>
<h3 id="store-message-and-reply">Store, Message and Reply</h3>
<p>The <em>Store</em> <a href="https://doc.rust-lang.org/std/keyword.struct.html"><em>struct</em></a> of your application
holds all the application's state. The <em>Store</em> can reference other model <em>structs</em>.</p>
<p>Rid assumes that all <em>Messages</em> may be handled asynchronously and thus will never make the
assumption that the state of the <em>Store</em> was modified in response to it after the <code>update</code>
method completes.</p>
<p>Instead it uses a <em>Request/Reply</em> mechanism to allow signaling that the state of the <em>Store</em>
was completely updated in response to a <em>Message</em>.</p>
<p>The <em>Message</em> is defined via an <a href="https://doc.rust-lang.org/std/keyword.enum.html"><em>enum</em></a>. It is used to send messages to the model and should be
the only means of mutating it. The variants of the message <em>enum</em> can have associated data
which is used to pass a message payload from Dart (see <code>Msg::Add(u32)</code> below).</p>
<p>The <em>Message</em> enum is associated with a <em>Reply</em> enum which is used to respond to messages after
they are handled.</p>
<p><strong>Example</strong></p>
<pre style="background-color:#2b303b;">
<code class="language-rust" data-lang="rust"><span style="color:#c0c5ce;">#[</span><span style="color:#bf616a;">rid</span><span style="color:#c0c5ce;">::</span><span style="color:#bf616a;">store</span><span style="color:#c0c5ce;">]
</span><span style="color:#b48ead;">pub struct </span><span style="color:#c0c5ce;">Store {
    </span><span style="color:#bf616a;">count</span><span style="color:#c0c5ce;">: </span><span style="color:#b48ead;">u32</span><span style="color:#c0c5ce;">,
}

</span><span style="color:#b48ead;">impl </span><span style="color:#c0c5ce;">rid::RidStore&lt;Msg&gt; </span><span style="color:#b48ead;">for </span><span style="color:#c0c5ce;">Store {
    </span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">create</span><span style="color:#c0c5ce;">() -&gt; </span><span style="color:#b48ead;">Self </span><span style="color:#c0c5ce;">{
        </span><span style="color:#b48ead;">Self </span><span style="color:#c0c5ce;">{ count: </span><span style="color:#d08770;">0 </span><span style="color:#c0c5ce;">}
    }

    </span><span style="color:#b48ead;">fn </span><span style="color:#8fa1b3;">update</span><span style="color:#c0c5ce;">(&amp;</span><span style="color:#b48ead;">mut </span><span style="color:#bf616a;">self</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">req_id</span><span style="color:#c0c5ce;">: </span><span style="color:#b48ead;">u64</span><span style="color:#c0c5ce;">, </span><span style="color:#bf616a;">msg</span><span style="color:#c0c5ce;">: Msg) {
        </span><span style="color:#b48ead;">match</span><span style="color:#c0c5ce;"> msg {
            Msg::Inc =&gt; {
                </span><span style="color:#bf616a;">self</span><span style="color:#c0c5ce;">.count += </span><span style="color:#d08770;">1</span><span style="color:#c0c5ce;">;
                rid::post(Reply::Increased(req_id));
            }
            Msg::Add(n) =&gt; {
                </span><span style="color:#bf616a;">self</span><span style="color:#c0c5ce;">.count += n;
                rid::post(Reply::Added(req_id, n.</span><span style="color:#96b5b4;">to_string</span><span style="color:#c0c5ce;">()));
            }
        }
    }
}

#[</span><span style="color:#bf616a;">rid</span><span style="color:#c0c5ce;">::</span><span style="color:#bf616a;">message</span><span style="color:#c0c5ce;">(Reply)]
#[</span><span style="color:#bf616a;">derive</span><span style="color:#c0c5ce;">(Debug, Clone)]
</span><span style="color:#b48ead;">pub enum </span><span style="color:#c0c5ce;">Msg {
    Inc,
    Add(</span><span style="color:#b48ead;">u32</span><span style="color:#c0c5ce;">),
}

#[</span><span style="color:#bf616a;">rid</span><span style="color:#c0c5ce;">::</span><span style="color:#bf616a;">reply</span><span style="color:#c0c5ce;">]
#[</span><span style="color:#bf616a;">derive</span><span style="color:#c0c5ce;">(Clone)]
</span><span style="color:#b48ead;">pub enum </span><span style="color:#c0c5ce;">Reply {
    Increased(</span><span style="color:#b48ead;">u64</span><span style="color:#c0c5ce;">),
    Added(</span><span style="color:#b48ead;">u64</span><span style="color:#c0c5ce;">, String),
}
</span></code></pre>
<p>As you can see the <code>#[rid::message(Reply)]</code> attribute defines the type of the <em>Reply</em> used to
respond to <em>Messages</em>.</p>
<p>ðŸ‘‰ read more about <a href="../../rid-attributes/message-reply/">rid::message and rid::reply</a></p>
<h2 id="accessing-state-and-sending-messages">Accessing State and Sending Messages</h2>
<p>As mentioned, all state is held by Rust. It is exposed to Flutter via a <em>Getter</em> based API.
State is only transfered once accessed in order to improve performance. To make things easier
the recommended API converts all data to Dart instances to avoid memory races and access
issues. </p>
<p>TODO: link separate document of higher level API details</p>
<p>For cases where more control is required and the performance suffers, i.e. when sending huge
lists of items, a lower level API is provided as well. As an example when using that API an item of a
<code>Vec&lt;u8&gt;</code> is only passed once it is accessed by indexing into the <em>collection</em>. However the
developer is now responsible to properly <em>lock</em> the <em>Store</em> to ensure that this vector wasn't
mutated in the meantime.</p>
<p>TODO: link separate document of raw API details</p>
<p>In response to user interaction like a button click we send messages to Rust in order to cause
the <em>Store</em> to be updated.</p>
<p>Using the recommended higher level API to interact with the above Rust <em>Store</em> from Flutter we
could do the following. </p>
<pre style="background-color:#2b303b;">
<code class="language-dart" data-lang="dart"><span style="color:#b48ead;">class </span><span style="color:#ebcb8b;">_MyHomePageState </span><span style="color:#b48ead;">extends </span><span style="color:#ebcb8b;">State</span><span style="color:#c0c5ce;">&lt;</span><span style="color:#ebcb8b;">MyHomePage</span><span style="color:#c0c5ce;">&gt; {
</span><span style="background-color:#65737e30;color:#c0c5ce;">  </span><span style="background-color:#65737e30;color:#b48ead;">final</span><span style="background-color:#65737e30;color:#c0c5ce;"> store = </span><span style="background-color:#65737e30;color:#ebcb8b;">Store</span><span style="background-color:#65737e30;color:#c0c5ce;">.instance;
</span><span style="color:#c0c5ce;">
  </span><span style="color:#b48ead;">@override
  </span><span style="color:#ebcb8b;">Widget </span><span style="color:#8fa1b3;">build</span><span style="color:#c0c5ce;">(</span><span style="color:#ebcb8b;">BuildContext</span><span style="color:#c0c5ce;"> context) {
    </span><span style="color:#b48ead;">return </span><span style="color:#ebcb8b;">Scaffold</span><span style="color:#c0c5ce;">(
      body: </span><span style="color:#ebcb8b;">Center</span><span style="color:#c0c5ce;">(
        child: </span><span style="color:#ebcb8b;">Column</span><span style="color:#c0c5ce;">(
          mainAxisAlignment: </span><span style="color:#ebcb8b;">MainAxisAlignment</span><span style="color:#c0c5ce;">.center,
          children: [
            </span><span style="color:#ebcb8b;">Text</span><span style="color:#c0c5ce;">(</span><span style="color:#a3be8c;">&#39;You have counted to:&#39;</span><span style="color:#c0c5ce;">),
</span><span style="background-color:#65737e30;color:#c0c5ce;">            </span><span style="background-color:#65737e30;color:#ebcb8b;">Text</span><span style="background-color:#65737e30;color:#c0c5ce;">(</span><span style="background-color:#65737e30;color:#a3be8c;">&#39;${</span><span style="background-color:#65737e30;color:#bf616a;">store.count</span><span style="background-color:#65737e30;color:#a3be8c;">}&#39;</span><span style="background-color:#65737e30;color:#c0c5ce;">),
</span><span style="color:#c0c5ce;">          ],
        ),
      ),
      floatingActionButton: </span><span style="color:#ebcb8b;">Row</span><span style="color:#c0c5ce;">(
        mainAxisAlignment: </span><span style="color:#ebcb8b;">MainAxisAlignment</span><span style="color:#c0c5ce;">.end,
        children: [
          </span><span style="color:#ebcb8b;">FloatingActionButton</span><span style="color:#c0c5ce;">(
            onPressed: () =&gt; { 
</span><span style="background-color:#65737e30;color:#c0c5ce;">              store.</span><span style="background-color:#65737e30;color:#8fa1b3;">msgAdd</span><span style="background-color:#65737e30;color:#c0c5ce;">(</span><span style="background-color:#65737e30;color:#d08770;">10</span><span style="background-color:#65737e30;color:#c0c5ce;">).</span><span style="background-color:#65737e30;color:#8fa1b3;">then</span><span style="background-color:#65737e30;color:#c0c5ce;">((_) =&gt; </span><span style="background-color:#65737e30;color:#8fa1b3;">setState</span><span style="background-color:#65737e30;color:#c0c5ce;">(() {})); 
</span><span style="color:#c0c5ce;">            }),
            child: </span><span style="color:#ebcb8b;">Icon</span><span style="color:#c0c5ce;">(</span><span style="color:#ebcb8b;">Icons</span><span style="color:#c0c5ce;">.add),
          ),
          </span><span style="color:#ebcb8b;">FloatingActionButton</span><span style="color:#c0c5ce;">(
            onPressed: () =&gt; { 
</span><span style="background-color:#65737e30;color:#c0c5ce;">              store.</span><span style="background-color:#65737e30;color:#8fa1b3;">msgInc</span><span style="background-color:#65737e30;color:#c0c5ce;">(</span><span style="background-color:#65737e30;color:#d08770;">10</span><span style="background-color:#65737e30;color:#c0c5ce;">).</span><span style="background-color:#65737e30;color:#8fa1b3;">then</span><span style="background-color:#65737e30;color:#c0c5ce;">((_) =&gt; </span><span style="background-color:#65737e30;color:#8fa1b3;">setState</span><span style="background-color:#65737e30;color:#c0c5ce;">(() {})); 
</span><span style="color:#c0c5ce;">            }),
            child: </span><span style="color:#ebcb8b;">Icon</span><span style="color:#c0c5ce;">(</span><span style="color:#ebcb8b;">Icons</span><span style="color:#c0c5ce;">.add),
          ),
        ],
      ),
    );
  }
}
</span></code></pre><h2 id="rid-s-raw-api">Rid's Raw Api</h2>
<p>TODO: This is a quick summary of the <em>raw</em> rid API. It will be moved into its own doc shortly and a
doc for the <em>recommended</em> higher level rid API will be provided alongside it.</p>
<h3 id="how-data-is-passed">How Data is Passed</h3>
<ul>
<li>primitives like <code>u8</code>, <code>i32</code> and C-style <code>enum</code>s are copied and passed <em>by value</em></li>
<li>strings like <code>String</code>, <code>&amp;str</code> are passed <em>by reference</em>, but Rid immediately releases them after
converting into a Dart String</li>
<li>structs are passed as pointers <em>by reference</em> and expose <em>Getters</em> to access their fields</li>
<li>collections like <code>Vec</code> are passed <em>by reference</em> and Rid exposes an <em>Iterable</em> interface to
provide access to each item</li>
</ul>
<h3 id="accessing-and-iterating-collections">Accessing and Iterating Collections</h3>
<p><em>Rid</em> wraps the retrieved <em>pointer</em> of a <em>collection</em> in an API that exposes a convenient
<em>iterable</em> interface as well as an indexing operator.</p>
<p>Have a look at the below list of <code>todos</code> defined on the <code>model</code>.</p>
<pre style="background-color:#2b303b;">
<code class="language-rust" data-lang="rust"><span style="color:#c0c5ce;">#[</span><span style="color:#bf616a;">rid</span><span style="color:#c0c5ce;">::</span><span style="color:#bf616a;">model</span><span style="color:#c0c5ce;">]
#[</span><span style="color:#bf616a;">derive</span><span style="color:#c0c5ce;">(Debug, rid::Debug)]
</span><span style="color:#b48ead;">pub struct </span><span style="color:#c0c5ce;">Todo {
    </span><span style="color:#bf616a;">title</span><span style="color:#c0c5ce;">: String
}

#[</span><span style="color:#bf616a;">rid</span><span style="color:#c0c5ce;">::</span><span style="color:#bf616a;">model</span><span style="color:#c0c5ce;">]
#[</span><span style="color:#bf616a;">rid</span><span style="color:#c0c5ce;">::</span><span style="color:#bf616a;">structs</span><span style="color:#c0c5ce;">(Todo)]
</span><span style="color:#b48ead;">pub struct </span><span style="color:#c0c5ce;">Model {
    </span><span style="color:#bf616a;">todos</span><span style="color:#c0c5ce;">: Vec&lt;Todo&gt;,
}
</span></code></pre>
<p><em>Note</em>: that we <code>#[derive(Debug, rid::Debug)]</code> for the <code>Todo</code> in order to call it from Flutter
via <code>todo.debug([pretty])</code>, see <a href="../../rid-attributes/debug/">rid::debug</a>.</p>
<p>Those <code>todos</code> can be used on the Flutter end like any <em>Iterable</em>.</p>
<pre style="background-color:#2b303b;">
<code class="language-dart" data-lang="dart"><span style="color:#8fa1b3;">queryTodos</span><span style="color:#c0c5ce;">(</span><span style="color:#ebcb8b;">Pointer</span><span style="color:#c0c5ce;">&lt;</span><span style="color:#ebcb8b;">Model</span><span style="color:#c0c5ce;">&gt; model) {
  </span><span style="color:#b48ead;">final</span><span style="color:#c0c5ce;"> todos = model.todos;
</span><span style="background-color:#65737e30;color:#c0c5ce;">  </span><span style="background-color:#65737e30;color:#b48ead;">final</span><span style="background-color:#65737e30;color:#c0c5ce;"> total = todos.length;
</span><span style="color:#c0c5ce;">
  </span><span style="color:#8fa1b3;">print</span><span style="color:#c0c5ce;">(</span><span style="color:#a3be8c;">&quot;Total Todos:     $</span><span style="color:#bf616a;">total</span><span style="color:#a3be8c;">&quot;</span><span style="color:#c0c5ce;">);
  </span><span style="color:#8fa1b3;">print</span><span style="color:#c0c5ce;">(</span><span style="color:#a3be8c;">&quot;</span><span style="color:#96b5b4;">\n</span><span style="color:#a3be8c;">Todos:&quot;</span><span style="color:#c0c5ce;">);
</span><span style="background-color:#65737e30;color:#c0c5ce;">  </span><span style="background-color:#65737e30;color:#b48ead;">for</span><span style="background-color:#65737e30;color:#c0c5ce;"> (</span><span style="background-color:#65737e30;color:#b48ead;">final</span><span style="background-color:#65737e30;color:#c0c5ce;"> todo </span><span style="background-color:#65737e30;color:#b48ead;">in</span><span style="background-color:#65737e30;color:#c0c5ce;"> matchingTodos.</span><span style="background-color:#65737e30;color:#8fa1b3;">iter</span><span style="background-color:#65737e30;color:#c0c5ce;">()) {
</span><span style="color:#c0c5ce;">    </span><span style="color:#8fa1b3;">print</span><span style="color:#c0c5ce;">(</span><span style="color:#a3be8c;">&quot;    ${</span><span style="color:#bf616a;">todo.debug()</span><span style="color:#a3be8c;">}&quot;</span><span style="color:#c0c5ce;">);
  }
  
</span><span style="background-color:#65737e30;color:#c0c5ce;">  </span><span style="background-color:#65737e30;color:#b48ead;">final</span><span style="background-color:#65737e30;color:#c0c5ce;"> firstTodo = todos[</span><span style="background-color:#65737e30;color:#d08770;">0</span><span style="background-color:#65737e30;color:#c0c5ce;">];
</span><span style="color:#c0c5ce;">  </span><span style="color:#b48ead;">final</span><span style="color:#c0c5ce;"> todoTitles = todos.</span><span style="color:#8fa1b3;">iter</span><span style="color:#c0c5ce;">().</span><span style="color:#8fa1b3;">map</span><span style="color:#c0c5ce;">((todo) =&gt; todo.title);
  </span><span style="color:#b48ead;">final</span><span style="color:#c0c5ce;"> todoSummedIds =
      todos.</span><span style="color:#8fa1b3;">iter</span><span style="color:#c0c5ce;">().</span><span style="color:#8fa1b3;">map</span><span style="color:#c0c5ce;">((todo) =&gt; todo.id).</span><span style="color:#8fa1b3;">reduce</span><span style="color:#c0c5ce;">((acc, id) =&gt; acc + id);
  </span><span style="color:#b48ead;">final</span><span style="color:#c0c5ce;"> todosUrgent =
</span><span style="background-color:#65737e30;color:#c0c5ce;">      todos.</span><span style="background-color:#65737e30;color:#8fa1b3;">iter</span><span style="background-color:#65737e30;color:#c0c5ce;">().</span><span style="background-color:#65737e30;color:#8fa1b3;">where</span><span style="background-color:#65737e30;color:#c0c5ce;">((todo) =&gt; todo.title.</span><span style="background-color:#65737e30;color:#8fa1b3;">contains</span><span style="background-color:#65737e30;color:#c0c5ce;">(</span><span style="background-color:#65737e30;color:#a3be8c;">&#39;urgent&#39;</span><span style="background-color:#65737e30;color:#c0c5ce;">));
</span><span style="color:#c0c5ce;">}
</span></code></pre>
<p><em>See also</em>: <a href="../../rid-attributes/structs-enums/">#rid::structs</a></p>

        
        
<div class="docs-navigation d-flex justify-content-between">
  
  
  
  
  
  <a href="https:&#x2F;&#x2F;thlorenz.com&#x2F;rid-site&#x2F;docs&#x2F;getting-started&#x2F;introduction&#x2F;">
    <div class="card my-1">
      <div class="card-body py-2">
        &larr; Introduction
      </div>
    </div>
  </a>
  

  
  
  
  
  
    
    
    
      
      
        
      
    
      
      
        
          
          
          <a class="ms-auto" href="https:&#x2F;&#x2F;thlorenz.com&#x2F;rid-site&#x2F;docs&#x2F;rid-attributes&#x2F;model&#x2F;">
            <div class="card my-1">
              <div class="card-body py-2">
                rid::model &rarr;
              </div>
            </div>
          </a>
          
          
          
        
      
    
      
      
        
      
    
      
      
        
      
    
  
</div>

      </main>
    </div>
  </div>
</div>


  
    
<footer class="footer text-muted">
	<div class="container">
		<div class="row">
			<div class="col-lg-8 order-last order-lg-first">
				<ul class="list-inline">
					
						<li class="list-inline-item">Powered by <a href="https://www.getzola.org/">Zola</a>, and <a href="https://github.com/aaranxu/adidoks">AdiDoks</a></li>
					
				</ul>
			</div>
			<div class="col-lg-8 order-first order-lg-last text-lg-end">
				<ul class="list-inline">
					
						
							<li class="list-inline-item"><a href="https://thlorenz.com/rid-site/docs/contributing/sponsor/">Sponsor</a></li>
						
							<li class="list-inline-item"><a href="https://thlorenz.com/rid-site/privacy-policy/">Privacy</a></li>
						
							<li class="list-inline-item"><a href="https://thlorenz.com/rid-site/docs/contributing/code-of-conduct/">Code of Conduct</a></li>
						
					
				</ul>
			</div>
		</div>
	</div>
</footer>

  

  
<script src="https://thlorenz.com/rid-site/js/main.js" defer></script>
<script async defer src="https://buttons.github.io/buttons.js"></script>

  <script src="https://thlorenz.com/rid-site/plugins/elasticlunr.min.js" defer></script>
  <script src="https://thlorenz.com/rid-site/search_index.en.js" defer></script>
  <script src="https://thlorenz.com/rid-site/js/search.js" defer></script>


<script async src="https://www.googletagmanager.com/gtag/js?id=G-6N055MM49B"></script>
<script>
  window.dataLayer = window.dataLayer || [];
  function gtag(){dataLayer.push(arguments);}
  gtag('js', new Date());

  gtag('config', 'G-6N055MM49B');
</script>

  
</body>
</html>
